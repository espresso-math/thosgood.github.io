<!DOCTYPE HTML>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <title>Tim Hosgood — Weighted limits, ends, and Day convolution (Part 3)</title>
  <link rel="stylesheet" href="/assets/style/tachyons.min.css">
  <link rel="stylesheet" href="/assets/katex/katex.min.css">
  <link rel="stylesheet" href="/assets/style/global.css">
</head>

  <body class="athelas">

    <div id="header" class="w-100 bb h3-ns">
  <div class="mw7 center pa3">
      <div class="w-100 tc pb2 pa0-ns mh0-ns tl-ns fl-ns w-third-ns">
        <a href="/index.html" class="f3 link black-80">Tim Hosgood</a>
      </div>

      <div class="w-100 tc mh0-ns tr-ns fl-ns w-two-thirds-ns">
        <ul class="list ph4 ma0 fr-ns">
          <li class="dib pr2 pr3-ns"><a href="/" >About</a></li>
          <li class="dib ph2 ph3-ns"><a href="/papers" >Papers</a></li>
          <li class="dib ph2 ph3-ns"><a href="/projects" >Projects</a></li>
          <li class="dib pl2 pl3-ns"><a href="/blog" >Blog</a></li>
        </ul>
      </div>
  </div>
</div>

    <div id="main" class="cf w-100 pv3-ns lh-copy">
      <div class="center ph4 pl5-ns pr7-ns mw7-ns">
        <h3 class="f3">Weighted limits, ends, and Day convolution (Part 3)</h4>
        <p>Finally, I find myself with enough motivation to start writing the last part to this series. It’s been a while, but hopefully nobody has actually been waiting… This is where we will finally see some of the exciting applications of (co)ends, including tensor products, geometric realisation, and Day convolution. One reason I’ve got around to writing this post is because coends (or, really, cowedges) appeared to me recently in a tweet about Stokes’ theorem, which I found pretty neat indeed — more details can be found in <a href="/blog/2019/09/04/stokes-coend.html">this post</a>.</p>

<!-- more -->

<hr />

<p>For a refresher on all the definitions, you can check out the two previous parts in this series (the links are at the top), because we’re just going to dive right in.</p>

<h2>Tensor products</h2>

<p>Let <script type="math/tex">\colon\mathcal{C}^\mathrm{op}\to\mathcal{D}</script> and <script type="math/tex">G\colon\mathcal{C}\to\mathcal{D}</script> be <script type="math/tex">\mathcal{V}</script>-functors. Then we define their <em>tensor product</em> to be, <strong>if it exists</strong>, the coend</p>

<script type="math/tex; mode=display">F\otimes_\mathcal{C}G = \int^{c\in\mathcal{C}}F(c)\otimes G(c).</script>

<p>As before, we have a non-enriched definition: whenever <script type="math/tex">\mathcal{D}</script> has <strong>all coproducts</strong>, we can define</p>

<script type="math/tex; mode=display">F\otimes_\mathcal{C}G = \int^{c\in\mathcal{C}}F(c)\cdot G(c)</script>

<p>where <script type="math/tex">S\cdot d=\coprod_{s\in S}d</script> for any set <script type="math/tex">S</script> and any object <script type="math/tex">d\in D</script>.</p>

<h3>Examples</h3>

<ul>
  <li>
    <p>Consider a ring <script type="math/tex">R</script> as a one-object <script type="math/tex">\mathsf{Ab}</script>-enriched. Then a right <script type="math/tex">R</script>-module gives an additive functor <script type="math/tex">R^\mathrm{op}\to\mathsf{Ab}</script>, and a left <script type="math/tex">R</script>-module gives an additive functor <script type="math/tex">R\to\mathsf{Ab}</script>. Then their tensor product, as <script type="math/tex">\mathsf{Ab}</script>-enriched functors, coincides with their usual tensor product as <script type="math/tex">R</script>-modules.</p>

    <p>This example is actually really linked to the theory of <em>profunctors</em>, which we will talk about below, but have already talked about <a href="{{ site.baseurl }}{% post_url 2019-07-14-cauchy-completion-and-profunctors %}#categorically">in a previous post</a>.</p>
  </li>
  <li>
    <p>The co-Yoneda lemma <script type="math/tex">F \cong \int^{c\in\mathcal{C}} \mathcal{C}(-,c)\otimes F(c)</script> can now just be written as</p>

    <script type="math/tex; mode=display">F\cong F\otimes_\mathcal{C}よ</script>

    <p>where <script type="math/tex">よ\colon\mathcal{C}\to\widehat{\mathcal{C}}</script> is the Yoneda embedding.</p>

    <p>This lets us state the powerful adage, that “representable functors generalise free modules. To see what this might mean, we state the co-Yoneda lemma applied to a representable functor, as well as a basic theorem about tensor products of free modules, and leave the drawing of connections between the two to the interested reader:</p>

    <script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}
      \operatorname{Hom}_\mathcal{C}(-,c)\otimes_\mathcal{C}F &\cong F(c)\\
      R^n\otimes_R M &\cong M^n.
  \end{aligned} %]]></script>

    <p>Suggestive, right?</p>
  </li>
  <li>
    <p>Geometric realisation of a simplicial set <script type="math/tex">X</script> can also be expressed as a tensor product. If we write <script type="math/tex">\vert-\vert\colon\Delta\to\mathsf{Top}</script> to mean the functor that sends <script type="math/tex">[n]</script> to the topological <script type="math/tex">n</script>-simplex, then we can write the geometric realisation <script type="math/tex">\vert X\vert</script> of <script type="math/tex">X</script> as</p>

    <script type="math/tex; mode=display">\vert X\vert\cong X\otimes_\Delta\vert-\vert.</script>
  </li>
</ul>

<h2>Day convolution</h2>

<p>As a motivation for the definition of Day convolution, we first recall the classical notion of convolution (albeit phrased in a more categorical language). Consider <script type="math/tex">\mathbb{N}</script> as a <strong>discrete</strong> category with addition as a monoidal product. Let <script type="math/tex">F,G\colon\mathbb{N}\to\mathsf{Set}</script> be functors, which we can think of as <em>graded sets</em>. Then their <em>convolution</em> <script type="math/tex">(F*G)\colon\mathbb{N}\to\mathsf{Set}</script> is defined by</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}
(F*G)(n) &= \sum_{i+j=n} F(i)\otimes G(j)\\
&= \sum_{i,j=1}^n F(i)\otimes G(j)\otimes\operatorname{Hom}_\mathbb{N}(n,i+j)
\end{aligned} %]]></script>

<p>where the second equality follows from the fact that <script type="math/tex">\mathbb{N}</script> is discrete. It might seem like an excessively abstract way of writing some Kronecker delta function, but it is exactly the thing that makes this definition easy to abstractify and generalise.</p>

<p>So now let <script type="math/tex">F,G\in\widehat{\mathcal{C}}=[\mathcal{C}^\mathrm{op},\mathcal{V}]=\mathsf{PrSh}_\mathcal{V}(\mathcal{C})</script> (or whichever other notation you most like that says that <script type="math/tex">F</script> and <script type="math/tex">G</script> are <script type="math/tex">\mathcal{V}</script>-valued presheaves). Then we define their <em>Day convolution</em> <script type="math/tex">(F*G)\in\widehat{\mathcal{C}}</script> by</p>

<script type="math/tex; mode=display">(F*G)(c) = \int^{x,x'\in\mathcal{C}} F(x)\otimes G(x')\otimes\operatorname{Hom}_\mathcal{C}(c,x\otimes x')</script>

<p>or, if you <em>really</em> like tensor-product notation more than coend notation, by</p>

<script type="math/tex; mode=display">(F*G)(c) = (F\otimes G)\otimes_{\mathcal{C}\times\mathcal{C}}\operatorname{Hom}_\mathcal{C}(-\otimes-).</script>

<p>As I already mentioned in my <a href="{{ site.baseurl }}{% post_url 2019-07-14-cauchy-completion-and-profunctors %}">post about profunctors</a>, there is a notion of Cauchy completion for presheaves. Something that I often heard say is that the presheaf category <em>itself</em> is the ‘free cocompletion’ of the original category. There are a bunch of ways of explaining what this means, but my favourite ‘proof’ is using Day convolution and the co-Yoneda lemma, to show that the Yoneda embedding <script type="math/tex">よ\colon\mathcal{C}\to\widehat{\mathcal{C}}</script> is <strong>monoidal</strong>:</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{aligned}
    &\big( \operatorname{Hom}_\mathcal{C}(-,x)*\operatorname{Hom}_\mathcal{C}(-,x') \big)(c)\\
    \cong &\int^{y,y'\in\mathcal{C}}\operatorname{Hom}_\mathcal{C}(y,x)\otimes\operatorname{Hom}_\mathcal{C}(y',x')\otimes\operatorname{Hom}_\mathcal{C}(c,y\otimes y')\\
    \cong &\int^{y\in\mathcal{C}}\operatorname{Hom}_\mathcal{C}(y,x)\otimes\operatorname{Hom}_\mathcal{C}(c,y\otimes x')\\
    \cong &\operatorname{Hom}_\mathcal{C}(c,x\otimes x')
\end{aligned} %]]></script>

<p>where the first isomorphism is by definition, and the last two are by co-Yoneda. That is,</p>

<script type="math/tex; mode=display">\operatorname{Hom}_\mathcal{C}(-,x)*\operatorname{Hom}_\mathcal{C}(-,x') \cong \operatorname{Hom}_\mathcal{C}(-,x\otimes x').</script>

<p>That is, <em>the Yoneda embedding is a (strong) monoidal functor</em></p>

<script type="math/tex; mode=display">(\mathcal{C},\otimes_\mathcal{C},I)\hookrightarrow(\widehat{\mathcal{C}},*,よ(I)).</script>

<p>Further, if <script type="math/tex">\mathcal{C}</script> is small, then there is an internal hom on <script type="math/tex">\widehat{\mathcal{C}}</script> which makes it <em>closed</em>.</p>

<p>Finally, as a fun little fact, which I used at some point in one of my masters theses,<sup id="fnref:2"><a href="#fn:2" class="footnote">1</a></sup> whenever <script type="math/tex">\mathcal{C}</script> is small and symmetric, (commutative) monoid objects in the enriched-presheaf category (with Day convolution) are equivalent to (symmetric) lax monoidal functors from <script type="math/tex">\mathcal{C}</script> to <script type="math/tex">\mathcal{V}</script>.</p>

<h3>Monoid algebra</h3>

<p>Remembering all that we’ve said above about free modules, and how Day convolution is basically the presheaf version of the tensor product from the original category, I would like to repeat some of what <a href="http://web.science.mq.edu.au/~alexc/">Alexander Campbell</a> wrote in response to a <a href="https://math.stackexchange.com/questions/1650786/day-convolution-intuition">question I asked about Day convolution</a> during the writing of my masters thesis.</p>

<p>There is a beautiful formal analogy between Day convolution and monoid algebra, which takes the following form:</p>

<table class="ba">
  <thead>
    <tr>
      <th>monoid algebra</th>
      <th>Day convolution</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>set</td>
      <td>category</td>
    </tr>
    <tr>
      <td>monoid</td>
      <td>monoidal category</td>
    </tr>
    <tr>
      <td>ring <script type="math/tex">R</script></td>
      <td>monoidally cocomplete<sup id="fnref:1"><a href="#fn:1" class="footnote">2</a></sup> category</td>
    </tr>
    <tr>
      <td><script type="math/tex">R</script>-module</td>
      <td>cocomplete <script type="math/tex">\mathcal{V}</script>-category</td>
    </tr>
    <tr>
      <td><script type="math/tex">R</script>-algebra</td>
      <td>monoidally cocomplete <script type="math/tex">\mathcal{V}</script>-category</td>
    </tr>
    <tr>
      <td>free <script type="math/tex">R</script>-module <script type="math/tex">R^{(X)}</script> on a set <script type="math/tex">X</script></td>
      <td>free cocomplete <script type="math/tex">\mathcal{V}</script>-category <script type="math/tex">\widehat{\mathcal{C}}</script> on a category <script type="math/tex">\mathcal{C}</script></td>
    </tr>
    <tr>
      <td>free <script type="math/tex">R</script>-module <script type="math/tex">R^{(X)}</script> on a monoid <script type="math/tex">M</script> with the convolution product</td>
      <td>free monoidally cocomplete <script type="math/tex">\mathcal{V}</script>-category <script type="math/tex">\widehat{\mathcal{A}}</script> on a monoidal category <script type="math/tex">\mathcal{A}</script> with Day convolution</td>
    </tr>
  </tbody>
</table>

<h2>Profunctors</h2>

<p>Just to have my obligatory “here is something that I don’t understand” that all of my posts seem to have, I wrote down in my notes (only a few weeks ago) the following sentence</p>

<pre><code>profunctors! composition is via coends
and this looks like ∃ for composition of relations
</code></pre>

<p>I have a vague idea of what this means: when we compose relations we do it ‘by existence’, in that</p>

<script type="math/tex; mode=display">SR(x,y)\iff\exists t\text{ s.t. }R(x,t)\wedge S(t,y)</script>

<p>and this somehow looks like a coend, but I have no idea (nor, really, the time (nor, really, the skill) to properly think about) how to make this formal. Any ideas?</p>

<hr />

<h1>Footnotes</h1>

<div class="footnotes">
  <ol>
    <li id="fn:2">
      <p>§4.1 in <a href="https://github.com/thosgood/papers/blob/master/under-spec-z-readers-companion/under-spec-z.pdf">Under Spec Z. A reader’s companion.</a>. It’s actually something that I’d love to come back to at some point! <a href="#fnref:2" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:1">
      <p>That is, a cocomplete monoidal category <script type="math/tex">\mathcal{V}</script> such that <script type="math/tex">\otimes\colon\mathcal{V}\times\mathcal{V}\to\mathcal{V}</script> is cocontinuous in each variable. <a href="#fnref:1" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

      </div>
    </div>
  
    <div id="footer" class="w-100 mb3 pv2 bt courier f6 h3-ns">
  <div class="center pa3 mw7-ns">
    <div class="w-100 ph4 fl-ns ph0-ns w-two-thirds-ns">
      <ul class="list pl0 ma0">
        <li>Tim Hosgood</li>
        <li>Université d'Aix-Marseille</li>
        <li><a href="mailto:thosgood@posteo.net" >thosgood@posteo.net</a></li>
      </ul>
    </div>

    <div class="w-100 ph4 fl-ns w-third-ns">
      <ul class="list ph0 mv2 ph2-ns ma0-ns fr-ns">
        <li><a href="https://arxiv.org/a/hosgood_t_1" >arXiv</a></li>
        <li><a href="https://github.com/thosgood" >GitHub</a></li>
      </ul>
      <ul class="list ph0 ma0 ph2-ns fr-ns">
        <li><a href="https://twitter.com/tjohnhos" >Twitter</a></li>
        <li><a href="https://matrix.to/#/@thosgood:matrix.org" >Matrix</a></li>
      </ul>
    </div>
  </div>
</div>


<script type="text/javascript" src="/assets/jquery-3.4.1.slim.min.js"></script>
<script type="text/javascript" src="/assets/katex/katex.min.js"></script>
<script type="text/javascript">
  $("script[type='math/tex']").replaceWith(
    function(){
      var tex = $(this).text();
      return "<span class=\"inline-equation\">" + 
             katex.renderToString(tex, {throwOnError: false}) +
             "</span>";
  });

  $("script[type='math/tex; mode=display']").replaceWith(
    function(){
      var tex = $(this).text();
      return "<div class=\"equation\">" + 
             katex.renderToString(tex, {displayMode: true, throwOnError: false}) +
             "</div>";
  });
</script>
<script type="text/javascript">
  $(document).ready(function () {
    var images = ['geometry.png', 'geometry2.png', 'greyzz.png', 'light_grey.png', 'pixel_weave.png', 'pw_pattern.png', 'sos.png'];
    var path = '/assets/backgrounds/';
    $('body').css({'background-image': 'url(' + path + images[Math.floor(Math.random() * images.length)] + ')'});
  });
</script>


  </body>
</html>
